function Bookcase(t, i, e, a, s, n) { this.container = t, this.originalData = e, this.userData = i, this.data = e, this.cateData = a, this.classData = s, this.departmentData = n, this.bookWidth = 130, this.offsetX = 20, this.rowHeight = 136, this.firstRowOverHeight = "1" == this.userData.isShowCategory ? 42 : 0, this.total = this.data.length, this.current = 1, this.pages = 1, this.needReload = !1, this.cache = [], this.skins = ["gold"], this.currentSkinId = this.skins.indexOf(i.skin || "gold"), this.isShowSkin = !1, this.sortBy = "New2Old", this.body = $("body"), this.body.addClass(i.skin ? i.skin : this.skins[this.currentSkinId]), this.panel = $("<div class='bookcase-panel'></div>"), this.navContainer = $("<div class='nav-container'><div class='nav-left'></div><div class='nav-middle'></div><div class='nav-right'></div></div>"), this.navBrandingContainer = $("<div class='nav-branding-container'></div>"), this.navTitle = $("<a rel='nofollow' class='font-style' target='_blank'>" + i.title + "</a>"), o = this.userData.logoLink, "" === o || o.match("http") || (o = "http://" + o), "" !== o && this.navTitle.attr("href", o), "0" === this.userData.isShowContact && this.navBrandingContainer.addClass("disabled"), this.searchContainer = $("<div class='search-container'></div>"), this.searchInput = $("<input class='input-style' type='text'>"), this.searchButton = $("<div class='search-icon'></div>"), this.searchCancelButton = $("<div class='search-cancel-icon hide'></div>"), "0" === this.userData.isShowSearch && this.searchContainer.addClass("hide"), this.caseContainer = $("<div class='case-container'></div>"), this.caseBackground = $("<div class='case-background'></div>"), this.casePageContainer = $("<div class='case-page-container user-select-none'></div>"), this.caseCateSelectContainer = $("<div class='case-cate-select-container'></div>"), this.caseCateSelectInner = $("<div class='case-cate-select-inner input-style as-input'></div>"), this.messageContainer = $("<div class='case-message vertical hide'></div>"), this.messageContent = $("<div class='vertical-content'></div>"), this.controlPanel = $("<div class='control-panel user-select-none'></div>"), this.prevButton = $("<div class='control-button control-prev-button'></div>"), this.nextButton = $("<div class='control-button control-next-button'></div>"), this.pageInput = $("<input type='text' class='page-num-input input-style'>"), this.skinButton = $("<div class='skin-button'></div>"), this.skinPanel = $("<ul class='skin-panel'><li></li><li></li><li></li><li></li><li></li></ul>"), "0" === this.userData.isShowSkin && this.skinButton.addClass("hide"), this.navRightButtonContainer = $("<div class='nav-right-button-container'></div>"), this.sortPanel = $("<div class='sort-panel user-select-none'></div>"), this.sortNameButton = $("<div class='sort-button sort-name-button'></div>"), this.sortCategoryButton = $("<div class='sort-button sort-cate-button'></div>"), this.sortDepartmentButton = $("<div class='sort-button sort-date-button'></div>"), this.bottomLogo = $("<span class='bottom-logo-link'></span>"), this.bottomLogoImg = $("<img />"); var o, h = ""; "1" === this.userData.isShowLogo && (this.bottomLogo.fadeIn(), h = this.userData.logoAddress, this.bottomLogoImg.attr("src", h)); var r = this, c = this.skinPanel.find("li"); c.eq(this.currentSkinId).addClass("skin-chosen"), this.skinButton.hammer().on("tap", function () { r.isShowSkin ? (r.skinPanel.css({ height: 0, bottom: 5, opacity: 0 }), r.isShowSkin = !1) : (r.skinPanel.css({ height: 200, bottom: 205, opacity: 1 }), r.isShowSkin = !0) }), this.skinPanel.find("li").each(function (t, i) { var e = $(i); e.hammer().on("tap", function () { c.eq(r.currentSkinId).removeClass("skin-chosen"), r.body.removeClass(r.skins[r.currentSkinId]), r.body.addClass(r.skins[t]), e.addClass("skin-chosen"), r.currentSkinId = t }) }), this.bottomLogo.hammer().on("tap", function () { "1" === r.userData.isShowContact && new UserDetailPanel(i) }), this.pageInput.on("keypress", function (t) { if (13 === t.which) { var i = r.pageInput.val().trim(), e = parseInt(i, 10); isNaN(e) && (e = 1), r.skipTo(e) } }), this.pageInput.on("focus", function () { r.pageInput.val("") }), this.pageInput.on("blur", function () { var t = r.pageInput.val().trim(); "" === t && r.pageInput.val(r.current + " / " + r.pages) }), this.casePageContainer.hammer().on("tap", ".book-img-wrapper", function () { var t = this.id; switch (r.data[t]._domainUrl = r.data[t].url, r.userData.openType) { case "1": DemoPanel(this.data.title, this.data._domainUrl); break; case "2": window.open(r.data[t]._domainUrl); break; default: new BookDetailPanel($(this).clone(), r.data[t], i.path) } }), this.searchButton.hammer().on("tap", this.search.bind(this)), this.searchCancelButton.hammer().on("tap", this.cancelSearch.bind(this)), this.searchInput.on("keypress", function (t) { 13 === t.which && r.search() }), utils.addPlaceHolder(this.searchInput, "Ara"), this.prevButton.hammer().on("tap", this.prev.bind(this)), this.nextButton.hammer().on("tap", this.next.bind(this)), this.caseContainer.on("touchmove", function (t) { t.preventDefault() }), this.casePageContainer.hammer().on("swipeleft", function () { r.next() }), this.casePageContainer.hammer().on("swiperight", function () { r.prev() }), this.panel.append(this.navContainer.append(this.bottomLogo.append(this.bottomLogoImg)).append(this.navBrandingContainer.append(this.navTitle)).append(this.searchContainer.append(this.searchInput).append(this.searchButton).append(this.searchCancelButton))).append(this.caseContainer.append(this.caseBackground).append(this.casePageContainer).append(this.messageContainer.append(this.messageContent)).append(this.navRightButtonContainer.append(this.sortPanel.append(this.sortNameButton).append(this.sortCategoryButton).append(this.sortDepartmentButton)))).append(this.controlPanel.append(this.prevButton).append(this.pageInput).append(this.nextButton).append(this.skinButton.append(this.skinPanel))).appendTo(t), this.classData.unshift({ value: "-1", label: "Hepsi", isDefault: !0 }), this.caseClassSelect = new SmartSelect({ container: this.sortNameButton, data: this.classData, changeCallback: function () { r.search() } }), this.cateData.unshift({ value: "-1", label: "Hepsi", isDefault: !0 }), this.caseCategorySelect = new SmartSelect({ container: this.sortCategoryButton, data: this.cateData, changeCallback: function () { r.search() } }), this.departmentData.unshift({ value: "-1", label: "Hepsi", isDefault: !0 }), this.caseDepartmentSelect = new SmartSelect({ container: this.sortDepartmentButton, data: this.departmentData, changeCallback: function () { r.search() } }); var d = null; $(window).on("resize", function () { clearTimeout(d), d = setTimeout(function () { r.resize() }, 50) }), this.resize() } function LightBox(t, i, e) { this.width = i, (window.innerWidth < i || "auto" == i) && (i = window.innerWidth), this.background = $("<div class='light-box-background'></div>"), this.box = $("<div class='light-box'></div>").width(i).addClass(e), this.panel = $("<div class='light-box-panel'></div>"), this.title = $("<div class='light-box-title'>" + t + "</div>"), this.cancelButton = $("<div class='light-box-cancel-button'>x</div>"), this.box.append(this.title.append(this.cancelButton)).append(this.panel), this.document = $(document), this.isNoResize = !1, $(window).on("resize", this.resize.bind(this, 0)), this.cancelButton.hammer().on("tap", this.cancel.bind(this)), this.background.hammer().on("tap", this.cancel.bind(this)) } function BookDetailPanel(t, i, e) { this.data = i, this.path = e, this.boxWidth = 485, this.lightBox = new LightBox("Ayr&#305;nt&#305;lar", this.boxWidth), this.panel = $("<div class='light-box-panel'></div>"), this.detailContainer = $("<div class='book-detail-container'></div>"), this.bookContainer = $("<div class='book-detail-book-container'></div>"), this.shelf = $("<img class='book-detail-book-shelf' src='" + e + "/Autorun/Includes/Bookcase/shelf.png'>"), this.title = $("<div class='book-detail-title'>" + i.title + "</div>"), this.info = $("<div class='book-detail-info'>Sayfa: " + i.pages + "</div>"), this.desc = $("<div class='book-detail-desc' title='" + i.description + "'>" + i.description + "</div>"), this.viewButton = $("<div class='button button-blue button-rounded button-block button-large'>A&ccedil;</div>"), this.downloadButton = $("<div class='button button-blue button-rounded button-block button-large'>&#304;ndir</div>"), "-1" == this.data.label ? this.viewButton.addClass("hide") : this.downloadButton.addClass("hide"), t.hammer().on("tap", this.view.bind(this)), this.viewButton.hammer().on("tap", this.view.bind(this)), this.downloadButton.hammer().on("tap", this.view.bind(this)), this.lightBox.getPanel().append(this.detailContainer.append(this.bookContainer.append(t.prepend(this.shelf))).append(this.title).append(this.info).append(this.desc).append(this.viewButton).append(this.downloadButton)), $(window).on("resize", this.resize.bind(this)), this.resize(), this.lightBox.launch() } function UserDetailPanel(t) { var i = new LightBox("&#304;leti&#351;im", 485); this.lightBox = i, this.data = t, this.userGroup = $("<div class='row user-info-container float-fix'></div>"), this.userLogoContainer = $("<div class='user-logo-container'></div>"), this.userLogo = $("<img src='" + t.accountLogo + "'>"), this.userInfoGroup = $("<div class='left user-info-group'></div>"), this.userName = $("<p>" + t.name + "</p>"), this.userAbout = $("<p>" + t.about + "</p>"), this.userWebsite = $("<p><strong>Web:</strong> <a target='_blank' href='http://" + t.website + "'>http://" + t.website + "</a></p>"), "" == t.website && this.userWebsite.addClass("hide"), this.contactForm = $("<div class='contactForm'><iframe src='http://iletisim.suratyayin.com/Mesaj.aspx?Yayin=2' style='width:450px;height:550px;scrolling:no;' frameborder='0'></iframe></div>"), i.getPanel().append(this.userGroup.append(this.userLogoContainer.append(this.userLogo)).append(this.userInfoGroup.append(this.userName).append(this.userAbout).append(this.userWebsite))).append(this.contactForm), i.launch(!0) } function SmartSelect(t) { var i = { container: null, data: [], changeCallback: function () { } }; this.options = $.extend({}, i, t), this.showing = !1; var e, a, s = this.options.data, n = s.length, o = this; for (this.valueContainer = $("<div class='hide'></div>"), this.optionContainer = $("<ul class='cc-smart-select-option-ul'></ul>"), e = 0; n > e; e++) this.optionContainer.append("<li data-value=" + s[e].value + " data-label='" + s[e].label + "'>" + s[e].label + "</li>"), s[e].isDefault && this.valueContainer.text(s[e].label).data("value", s[e].value); this.options.container.append(this.optionContainer), a = this.optionContainer.find("li"), a.css({ paddingLeft: this.options.container.css("paddingLeft") }), o.optionContainer.hide(), this.optionContainer.hammer().on("tap", this.choose.bind(this)), this.options.container.hammer().on("tap", this.toggleOption.bind(this)), $(document).hammer().on("tap", function (t) { $.contains(o.options.container[0], t.target) || o.options.container[0] == t.target || o.hideOptions() }) } var utils = { encodeHTML: function (t) { return ("undefined" == typeof t || null == t) && (t = ""), t.replace(/&/g, "&").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/\\/g, "&#92;").replace(/"/g, "&quot;").replace(/'/g, "&#39;").replace(/\n/g, "<br>") }, addPlaceHolder: function (t, i) { t.val(i), t.on("focus", function () { t.val().trim() === i && t.val("") }), t.on("blur", function () { "" === t.val().trim() && t.val(i) }) }, parseDate: function (t) { var i = t.split(" "), e = i[0].split("."), a = i[1].split(":"); return new Date(e[2], e[1] - 1, e[0], a[0], a[1], a[2]) }, nl2br: function (t) { return t.replace(/\n/g, "<br>") }, br2nl: function (t) { return t.replace(/<.?br.?>/g, "\n") }, validateForm: function (t) { var i = !1; return t.find("input, textarea").each(function (t, e) { var a = $(e), s = a.val().trim(); "" === s || "email" === a.attr("type") && -1 === s.lastIndexOf("@") ? (a.addClass("invalid"), i = !0) : a.removeClass("invalid") }), !i }, loadImg: function (t) { var i = 0, e = t.length; for (i = 0; e > i; i++) { var a = new Image; a.src = t[i] } } }; Bookcase.prototype = { shakeMessage: function () { this.messageContainer.animate({ left: "-=2px" }, 50).animate({ left: "+=4px" }, 50).animate({ left: "-=4px" }, 50).animate({ left: "+=2px" }, 50) }, showMessage: function (t, i) { this.messageContent.html(t), this.messageContainer.stop(!0, !0).fadeIn(), i && this.messageContainer.stop(!0, !0).delay(1e3).fadeOut() }, hideMessage: function () { this.messageContainer.hide() }, getInputAutoWidth: function (t) { var i = this.pageInput.val(), e = $("<div></div>").text(i).css({ fontSize: this.pageInput.css("font-size"), display: this.pageInput.css("display"), padding: this.pageInput.css("padding"), opacity: 0 }).appendTo(t.parent()), a = e.outerWidth(); return e.remove(), 2 * a }, cancelSearch: function () { this.searchInput.val("").focus(), this.searchCancelButton.hide(), this.searchButton.show(), this.hideMessage(0), this.search() }, search: function () { var t, i = this, e = this.searchInput.val().trim().toLowerCase(), a = this.caseCategorySelect && this.caseCategorySelect.val(), s = this.caseClassSelect && this.caseClassSelect.val(), n = this.caseDepartmentSelect && this.caseDepartmentSelect.val(), o = this.originalData.length, h = []; for ("ara" === e && (e = ""), "" != e ? (this.searchButton.hide(), this.searchCancelButton.show()) : (this.searchButton.show(), this.searchCancelButton.hide()), t = 0; o > t; t++) { var r = this.originalData[t].title.toLowerCase(), c = this.originalData[t].description.toLowerCase(); (r.match(e) || c.match(e)) && !(this.originalData[t].categoryid != a && -1 != a || this.originalData[t].sinifid != s && -1 != s || this.originalData[t].bransid != n && -1 != n || !h.push(this.originalData[t])) } if (this.data = h, this.resize(!0), 0 === h.length) { var d = $("<p>Sonu&ccedil; yok. </p>"), l = $("<a href='javascript:void(0);'>Geri</a>").appendTo(d); l.hammer().on("tap", function () { i.cancelSearch() }), i.showMessage(d) } else i.hideMessage() }, autoFitToBottom: function (t, i, e, a) { var s = this, n = new Image, o = $("<div class='loading'><img src='Includes/Bookcase/loading.gif'></div>").appendTo(t); n.onload = function () { var h, r, c = t.height(), d = t.width(), l = n.width / n.height, p = c, u = c * l; u > d && (u = d, p = d / l), h = (d - u) / 2, r = c - p, i.css({ width: u, height: p, left: h, top: r }); var g, v = 4, f = $("<div class='book-border-container'></div>"); for (f.css({ right: -v, width: v }), g = 0; v > g; g++) { $("<div></div>").css({ position: "absolute", width: 1, background: g % 2 == 0 ? "#ccc" : "#fff", height: p - 2 * (g + 1), top: g + 1, left: g + 1 }).appendTo(f) } e.after(f), setTimeout(function () { i.fadeIn(400, function () { s.cache[a] = t }), o.remove() }, 50) }, n.onerror = function () { var n, h, r = $("<div class='as-book-img'></div>"), c = t.height(), d = t.width(), l = .75, p = c, u = c * l; u > d && (u = d, p = d / l), n = (d - u) / 2, h = c - p, i.css({ width: u, height: p, left: n, top: h }); var g, v = 4, f = $("<div class='book-border-container'></div>"); for (f.css({ right: -v, width: v }), g = 0; v > g; g++) { $("<div></div>").css({ position: "absolute", width: 1, background: g % 2 == 0 ? "#ccc" : "#fff", height: p - 2 * (g + 1), top: g + 1, left: g + 1 }).appendTo(f) } e.after(r).after(f), setTimeout(function () { e.hide(), i.fadeIn(400, function () { s.cache[a] = t }) }, 50), o.remove() }, n.src = e.attr("src") }, skipTo: function (t) { if (t > this.pages ? t = this.pages : 1 > t && (t = 1), this.pageInput.val(t + " / " + this.pages), t != this.current || this.needReload) { var i = this.casePageContainer.find("#page-" + this.current), e = this.casePageContainer.find("#page-" + t), a = this.casePageContainer.find("#page-" + (t - 1)), s = this.casePageContainer.find("#page-" + (t + 1)); e && e.length > 0 || (e = this.createPage(t)), t < this.current ? (i.css({ webkitTransform: "translateX(100%)", mozTransform: "translateX(100%)", oTransform: "translateX(100%)", msTransform: "translateX(100%)", transform: "translateX(100%)", opacity: 0 }), e.css({ webkitTransform: "translateX(0%)", mozTransform: "translateX(0%)", oTransform: "translateX(0%)", msTransform: "translateX(0%)", transform: "translateX(0%)", opacity: 1 })) : (i.css({ webkitTransform: "translateX(-100%)", mozTransform: "translateX(-100%)", oTransform: "translateX(-100%)", msTransform: "translateX(-100%)", transform: "translateX(-100%)", opacity: 0 }), e.css({ webkitTransform: "translateX(0%)", mozTransform: "translateX(0%)", oTransform: "translateX(0%)", msTransform: "translateX(0%)", transform: "translateX(0%)", opacity: 1 })), t === this.pages || s && s.length > 0 || this.createPage(t + 1, !0), 1 === t || a && a.length > 0 || this.createPage(t - 1, !0), 1 === t ? (this.prevButton.addClass("disabled"), this.nextButton.removeClass("disabled")) : t === this.pages ? (this.nextButton.addClass("disabled"), this.prevButton.removeClass("disabled")) : (this.prevButton.removeClass("disabled"), this.nextButton.removeClass("disabled")), 1 === this.pages && (this.prevButton.addClass("disabled"), this.nextButton.addClass("disabled")), this.current = t } }, getLabelFilePath: function (t) { var i = ""; switch (t) { case "1": i = "Includes/Bookcase/label-new.png"; break; case "2": i = "Includes/Bookcase/label-hot.png"; break; case "3": i = "Includes/Bookcase/label-featured.png" } return i }, createPage: function (t) { var i = $("<div id='page-" + t + "' class='single-page'></div>"); for (r = 0; r < this.rows; r++) { for ($row = $("1" == this.userData.isShowCategory && 0 == r ? "<div class='case-row big'></div>" : "<div class='case-row'></div>"), $bookWarpper = $("<div class='book-wrapper'></div>").width(this.cols * this.bookWidth), c = 0; c < this.cols; c++) index = (t - 1) * this.rows * this.cols + r * this.cols + c, index < this.total && (this.cache[index] && this.cache[index].length > 0 ? $bookContianer = this.cache[index] : ($bookContianer = $("<div class='book-container'></div>"), $imgWrapper = $("<div id='" + index + "' class='book-img-wrapper'></div>"), $img = $("<img class='book-img' src='" + this.data[index].kapak + "'/>").appendTo($bookContianer), $label = $("<img class='book-label' src='" + this.getLabelFilePath(this.data[index].label) + "'>"), $priceLabel = $("<div class='price-label' title='" + this.data[index].sinif + "'>" + this.data[index].sinif + "</div>"), "0" == this.data[index].label && $label.hide(), "-1" == this.data[index].label && ($label.hide(), $img.addClass("bright")), $bookContianer.append($imgWrapper.append($img).append($label).append($priceLabel)), this.autoFitToBottom($bookContianer, $imgWrapper, $img, index)), $bookContianer.appendTo($bookWarpper)); $row.append($bookWarpper).appendTo(i) } return i.appendTo(this.casePageContainer), i }, prev: function () { 1 !== this.current && this.skipTo(this.current - 1) }, next: function () { this.current !== this.pages && this.skipTo(this.current + 1) }, resize: function (t) { t && (this.total = this.data.length, this.cache = []), "undefined" == typeof this.topHeight && (this.topHeight = this.navContainer.height(), this.bottomHeight = this.controlPanel.height()); var i, e = this.container.height(), a = this.container.width(), s = Math.floor((e - this.topHeight - this.firstRowOverHeight) / this.rowHeight), s = s > 0 ? s : 1, n = Math.floor((a - 2 * this.offsetX) / this.bookWidth), o = Math.ceil(this.total / (s * n)) || 1; for (this.navRightButtonContainer.css("left", Math.floor((a - this.navRightButtonContainer.width()) / 2)), t || s !== this.rows || n != this.cols ? (this.casePageContainer.empty(), this.needReload = !0) : this.needReload = !1, this.rows = s, this.cols = n, this.pages = o, this.caseBackground.empty(), i = 0; s > i; i++) this.caseBackground.append("1" == this.userData.isShowCategory && 0 == i ? $("<div class='case-row big'><div class='case-left'></div><div class='case-middle'></div><div class='case-right'></div></div>") : $("<div class='case-row'><div class='case-left'></div><div class='case-middle'></div><div class='case-right'></div></div>")); this.current > this.pages && (this.current = this.pages), this.skipTo(this.current), this.pageInput.width(this.getInputAutoWidth(this.pageInput)) } }, LightBox.prototype = { constructor: LightBox, getBox: function () { return this.box }, getPanel: function () { return this.panel }, launch: function (t) { var i, e = $("body"), a = this; if (t) { var s = this.box.find("input, textarea"); s.each(function (t, i) { var e = $(i); e.on("focus", function () { a.isNoResize = !0 }), e.on("blur", function () { a.isNoResize = !1 }) }) } this.background.appendTo(e).fadeIn(), this.box.appendTo(e), this.resize(0), i = a.box.height() > window.innerHeight ? a.document.scrollTop() + 0 : (window.innerHeight - this.box.height()) / 2 + this.document.scrollTop(), this.box.css("top", this.document.scrollTop()).animate({ opacity: 1, top: i }, 200) }, cancel: function () { var t = this; t.background.fadeOut(function () { t.background.remove() }), t.box.animate({ opacity: 0, top: this.document.scrollTop() }, 200, function () { t.box.remove() }) }, resizeH: function () { this.box.css({ left: (window.innerWidth - this.box.width()) / 2 }) }, resize: function (t) { if (this.box.width(window.innerWidth < this.width || "auto" == this.width ? window.innerWidth : this.width), !this.isNoResize) { "undefined" == typeof t && (t = 400); var i; i = this.box.outerHeight() > window.innerHeight ? this.document.scrollTop() : this.document.scrollTop() + (window.innerHeight - this.box.outerHeight()) / 2, this.box.animate({ left: (window.innerWidth - this.box.outerWidth()) / 2, top: i }, t) } } }, BookDetailPanel.prototype = { view: function () { RunFile(this.data._domainUrl) }, resize: function () { this.detailContainer.width((window.innerWidth < this.boxWidth ? window.innerWidth : this.boxWidth) - 270) } }, UserDetailPanel.prototype = { close: function () { this.lightBox.cancel() } }, SmartSelect.prototype = { constructor: SmartSelect, val: function () { return this.valueContainer.data("value") }, choose: function (t) { $target = $(t.target), $target.is("li") && (this.valueContainer.text($target.data("label")).data("value", $target.data("value")), this.options.changeCallback && this.options.changeCallback($target.data("value"))) }, toggleOption: function () { this.showing ? this.hideOptions() : this.showOptions() }, showOptions: function () { var t = this; t.optionContainer.stop().show().animate({ marginTop: 0, opacity: 1 }, 200, function () { t.showing = !0 }) }, hideOptions: function () { var t = this; t.optionContainer.stop().animate({ marginTop: -3, opacity: 0 }, 100, function () { t.showing = !1, t.optionContainer.hide() }) } };